#!/usr/bin/env bash

# swaps occurences of $CHPL_HOME in the output with the string: "{CHPL_HOME}"

tmpfile=$2

tmptmp=`mktemp "tmp.XXXXXX"`

regex="s~$CHPL_HOME~{CHPL_HOME}~g"
sed -e "$regex" $tmpfile > $tmptmp

# also use realpath to work with absolute paths
realhome=`realpath $CHPL_HOME`
regex="s~$realhome~{CHPL_HOME}~g"
sed -e "$regex" $tmpfile > $tmptmp

mv $tmptmp $tmpfile
